/** MIT License
* 
* Copyright (c) 2010 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* https://github.com/LCluber/Aias.js
*/

var Aias=function(e){"use strict";function l(e){"@babel/helpers - typeof";return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function a(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,u=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){u=!0,s=e},f:function(){try{i||null==r.return||r.return()}finally{if(u)throw s}}}}function i(e){return e<10?"0"+e:e}function h(e){return null!==e&&"object"===l(e)&&!(null!==(t=e)&&t.constructor===Array);var t}function r(e,t){function r(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function d(e){return"function"==typeof e}function s(e){setTimeout(function(){throw e},0)}function p(e){return e.reduce(function(e,t){return e.concat(t instanceof N?t.errors:t)},[])}function y(){}function v(e){if(e||(e=Promise),!e)throw new Error("no Promise impl found");return e}function b(e){return Boolean(e&&void 0!==e.length)}function m(){}function T(e){if(!(this instanceof T))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],_(e,this)}function g(r,n){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,T._immediateFn(function(){var e=1===r._state?n.onFulfilled:n.onRejected;if(null!==e){var t;try{t=e(r._value)}catch(e){return void E(n.promise,e)}w(n.promise,t)}else(1===r._state?w:E)(n.promise,r._value)})):r._deferreds.push(n)}function w(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===l(e)||"function"==typeof e)){var r=e.then;if(e instanceof T)return t._state=3,t._value=e,void x(t);if("function"==typeof r)return void _((n=r,o=e,function(){n.apply(o,arguments)}),t)}t._state=1,t._value=e,x(t)}catch(e){E(t,e)}var n,o}function E(e,t){e._state=2,e._value=t,x(e)}function x(e){2===e._state&&0===e._deferreds.length&&T._immediateFn(function(){e._handled||T._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)g(e,e._deferreds[t]);e._deferreds=null}function k(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function _(e,t){var r=!1;try{e(function(e){r||(r=!0,w(t,e))},function(e){r||(r=!0,E(t,e))})}catch(e){if(r)return;r=!0,E(t,e)}}function S(e){return e<10?"0"+e:e}var O={info:{id:1,name:"info",color:"#28a745"},trace:{id:2,name:"trace",color:"#17a2b8"},warn:{id:3,name:"warn",color:"#ffc107"},error:{id:4,name:"error",color:"#dc3545"},off:{id:99,name:"off",color:null}},P=function(){function s(e,t){var r,n,o;u(this,s),this.id=e.id,this.name=e.name,this.color=e.color,this.content=t,this.date=(r=new Date,n=[i(r.getMonth()+1),i(r.getDate()),r.getFullYear().toString().substr(-2)],o=[i(r.getHours()),i(r.getMinutes()),i(r.getSeconds())],n.join("/")+" "+o.join(":"))}return t(s,[{key:"display",value:function(){}}]),s}(),A=function(){function r(e,t){u(this,r),this.messages=[],this.name=e,this.messages=[],this.level=t}return t(r,[{key:"setLevel",value:function(e){return this.level=O.hasOwnProperty(e)?O[e]:this.level,this.getLevel()}},{key:"getLevel",value:function(){return this.level.name}},{key:"info",value:function(e){this.log(O.info,e)}},{key:"trace",value:function(e){this.log(O.trace,e)}},{key:"warn",value:function(e){this.log(O.warn,e)}},{key:"error",value:function(e){this.log(O.error,e)}},{key:"log",value:function(e,t){var r=new P(e,t);this.messages.push(r),this.level.id<=r.id&&r.display(this.name)}}]),r}(),H=function(){function o(){u(this,o)}return t(o,null,[{key:"setLevel",value:function(e){o.level=O.hasOwnProperty(e)?O[e]:o.level;var t,r=f(o.groups);try{for(r.s();!(t=r.n()).done;){t.value.setLevel(o.level.name)}}catch(e){r.e(e)}finally{r.f()}return o.getLevel()}},{key:"getLevel",value:function(){return o.level.name}},{key:"getGroup",value:function(e){var t,r=f(o.groups);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.name===e)return n}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"addGroup",value:function(e){return this.getGroup(e)||this.pushGroup(e)}},{key:"pushGroup",value:function(e){var t=new A(e,o.level);return o.groups.push(t),t}}]),o}();H.level=O.error,H.groups=[];var C=function(e,t){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},L=!1,D={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e);L=e},get useDeprecatedSynchronousErrorHandling(){return L}},j={closed:!0,next:function(){},error:function(e){if(D.useDeprecatedSynchronousErrorHandling)throw e;s(e)},complete:function(){}},I=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}(),N=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),q=function(){function a(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var e;return a.prototype.unsubscribe=function(){var t;if(!this.closed){var e,r=this._parentOrParents,n=this._unsubscribe,o=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof a)r.remove(this);else if(null!==r)for(var s=0;s<r.length;++s){r[s].remove(this)}if(d(n))try{n.call(this)}catch(e){t=e instanceof N?p(e.errors):[e]}if(I(o)){s=-1;for(var i=o.length;++s<i;){var u=o[s];if(null!==(e=u)&&"object"===l(e))try{u.unsubscribe()}catch(e){t=t||[],e instanceof N?t=t.concat(p(e.errors)):t.push(e)}}}if(t)throw new N(t)}},a.prototype.add=function(e){var t=e;if(!e)return a.EMPTY;switch(l(e)){case"function":t=new a(e);case"object":if(t===this||t.closed||"function"!=typeof t.unsubscribe)return t;if(this.closed)return t.unsubscribe(),t;if(!(t instanceof a)){var r=t;(t=new a)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var n=t._parentOrParents;if(null===n)t._parentOrParents=this;else if(n instanceof a){if(n===this)return t;t._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return t;n.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[t]:o.push(t),t},a.prototype.remove=function(e){var t=this._subscriptions;if(t){var r=t.indexOf(e);-1!==r&&t.splice(r,1)}},a.EMPTY=((e=new a).closed=!0,e),a}(),R=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),G=function(o){function s(e,t,r){var n=o.call(this)||this;switch(n.syncErrorValue=null,n.syncErrorThrown=!1,n.syncErrorThrowable=!1,n.isStopped=!1,arguments.length){case 0:n.destination=j;break;case 1:if(!e){n.destination=j;break}if("object"===l(e)){e instanceof s?(n.syncErrorThrowable=e.syncErrorThrowable,(n.destination=e).add(n)):(n.syncErrorThrowable=!0,n.destination=new M(n,e));break}default:n.syncErrorThrowable=!0,n.destination=new M(n,e,t,r)}return n}return r(s,o),s.prototype[R]=function(){return this},s.create=function(e,t,r){var n=new s(e,t,r);return n.syncErrorThrowable=!1,n},s.prototype.next=function(e){this.isStopped||this._next(e)},s.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},s.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},s.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},s.prototype._next=function(e){this.destination.next(e)},s.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},s.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},s.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},s}(q),M=function(u){function e(e,t,r,n){var o,s=u.call(this)||this;s._parentSubscriber=e;var i=s;return d(t)?o=t:t&&(o=t.next,r=t.error,n=t.complete,t!==j&&(d((i=Object.create(t)).unsubscribe)&&s.add(i.unsubscribe.bind(i)),i.unsubscribe=s.unsubscribe.bind(s))),s._context=i,s._next=o,s._error=r,s._complete=n,s}return r(e,u),e.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;D.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},e.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,r=D.useDeprecatedSynchronousErrorHandling;if(this._error)r&&t.syncErrorThrowable?this.__tryOrSetError(t,this._error,e):this.__tryOrUnsub(this._error,e),this.unsubscribe();else if(t.syncErrorThrowable)r?(t.syncErrorValue=e,t.syncErrorThrown=!0):s(e),this.unsubscribe();else{if(this.unsubscribe(),r)throw e;s(e)}}},e.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var r=function(){return e._complete.call(e._context)};D.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,r):this.__tryOrUnsub(r),this.unsubscribe()}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),D.useDeprecatedSynchronousErrorHandling)throw e;s(e)}},e.prototype.__tryOrSetError=function(t,e,r){if(!D.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return D.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0):(s(e),!0)}return!1},e.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},e}(G),U=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}(),W=function(){function r(e){this._isScalar=!1,e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,r){var n=this.operator,o=function(e,t,r){if(e){if(e instanceof G)return e;if(e[R])return e[R]()}return e||t||r?new G(e,t,r):new G(j)}(e,t,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||D.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),D.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},r.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){D.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(e){for(;e;){var t=e,r=t.closed,n=t.destination,o=t.isStopped;if(r||o)return!1;e=n&&n instanceof G?n:null}return!0}(t)&&t.error(e)}},r.prototype.forEach=function(n,e){var o=this;return new(e=v(e))(function(e,t){var r;r=o.subscribe(function(e){try{n(e)}catch(e){t(e),r&&r.unsubscribe()}},t,e)})},r.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},r.prototype[U]=function(){return this},r.prototype.pipe=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 0===e.length?this:((t=e)?1===t.length?t[0]:function(e){return t.reduce(function(e,t){return t(e)},e)}:y)(this)},r.prototype.toPromise=function(e){var n=this;return new(e=v(e))(function(e,t){var r;n.subscribe(function(e){return r=e},function(e){return t(e)},function(){return e(r)})})},r.create=function(e){return new r(e)},r}(),F=setTimeout;T.prototype.catch=function(e){return this.then(null,e)},T.prototype.then=function(e,t){var r=new this.constructor(m);return g(this,new k(e,t,r)),r},T.prototype.finally=function(t){var r=this.constructor;return this.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){return r.reject(e)})})},T.all=function(t){return new T(function(n,o){function s(t,e){try{if(e&&("object"===l(e)||"function"==typeof e)){var r=e.then;if("function"==typeof r)return void r.call(e,function(e){s(t,e)},o)}i[t]=e,0==--u&&n(i)}catch(e){o(e)}}if(!b(t))return o(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return n([]);for(var u=i.length,e=0;e<i.length;e++)s(e,i[e])})},T.resolve=function(t){return t&&"object"===l(t)&&t.constructor===T?t:new T(function(e){e(t)})},T.reject=function(r){return new T(function(e,t){t(r)})},T.race=function(o){return new T(function(e,t){if(!b(o))return t(new TypeError("Promise.race accepts an array"));for(var r=0,n=o.length;r<n;r++)T.resolve(o[r]).then(e,t)})},T._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){F(e,0)},T._unhandledRejectionFn=function(){"undefined"!=typeof console&&console},Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(null==this)throw new TypeError('"this" is null or not defined');var r,n,o=Object(this),s=o.length>>>0;if(0===s)return!1;for(var i=0|t,u=Math.max(0<=i?i:s-Math.abs(i),0);u<s;){if((r=o[u])===(n=e)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;u++}return!1}});var V=window.AudioContext||window.webkitAudioContext||!1,J=function(){function i(e,t,r,n,o,s){u(this,i),this.eventType="promise",this.log=H.addGroup("Aias"),this.method=e,this.url=t,this.responseType=r,this.async=!0,this.noCache=!1,this.headers=n,this.eventType=o||this.eventType,this.data=s||null}return t(i,[{key:"call",value:function(){switch(this.eventType){case"observable":return this.useObservable(this.url,this.responseType,this.data);default:return this.usePromise(this.url,this.responseType,this.data)}}},{key:"usePromise",value:function(s,i,e){var u=this;return new T(function(r,n){var o=new XMLHttpRequest;switch(s+=u.noCache?"?cache="+(new Date).getTime():"",o.open(u.method,s,u.async),o.responseType="audiobuffer"===i?"arraybuffer":i,u.setRequestHeaders(o),i){case"json":case"arraybuffer":case"audiobuffer":case"blob":o.onload=function(){if(4==o.readyState)if(200==o.status){var e=o.response;if(e)if(u.logInfo(s,o.status,o.statusText),"audiobuffer"===i)if(V){var t=new V;t.decodeAudioData(e,function(e){t.close(),r(e)},function(e){u.log.error("xhr ("+u.method+":"+s+") failed with decodeAudioData error : "+e.message),t.close(),n({status:e.name,statusText:e.message})})}else u.log.error("xhr ("+u.method+":"+s+") failed with error : Web Audio API is not supported by your browser."),n({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"});else r(e);else u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})}else u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})};break;default:o.onreadystatechange=function(){4==o.readyState&&(200==o.status?(u.logInfo(s,o.status,o.statusText),r(o.responseText)):(u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})))}}h(e)&&(e=JSON.stringify(e)),o.send(e||null),u.log.info("xhr ("+u.method+":"+s+")sent")})}},{key:"useObservable",value:function(o,s,e){var i=this;return new W(function(r){var n=new XMLHttpRequest;switch(o+=i.noCache?"?cache="+(new Date).getTime():"",n.open(i.method,o,i.async),n.responseType="audiobuffer"===s?"arraybuffer":s,i.setRequestHeaders(n),s){case"json":case"arraybuffer":case"audiobuffer":case"blob":n.onload=function(){if(4==n.readyState)if(200==n.status){var e=n.response;if(e)if(i.logInfo(o,n.status,n.statusText),"audiobuffer"===s)if(V){var t=new V;t.decodeAudioData(e,function(e){t.close(),r.next(e),r.complete()},function(e){i.log.error("xhr ("+i.method+":"+o+") failed with decodeAudioData error : "+e.message),t.close(),r.error({status:e.name,statusText:e.message}),r.complete()})}else i.log.error("xhr ("+i.method+":"+o+") failed with error : Web Audio API is not supported by your browser."),r.error({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"}),r.complete();else r.next(e),r.complete();else i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText}),r.complete()}else i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText}),r.complete()};break;default:n.onreadystatechange=function(){4==n.readyState&&(200==n.status?(i.logInfo(o,n.status,n.statusText),r.next(n.responseText)):(i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText})),r.complete())}}h(e)&&(e=JSON.stringify(e)),n.send(e||null),i.log.info("xhr ("+i.method+":"+o+")sent")})}},{key:"setRequestHeaders",value:function(e){for(var t in this.headers)this.headers.hasOwnProperty(t)&&e.setRequestHeader(t,this.headers[t])}},{key:"logInfo",value:function(e,t,r){this.log.info("xhr ("+this.method+":"+e+") done with status "+t+" "+r)}},{key:"logError",value:function(e,t,r){this.log.error("xhr ("+this.method+":"+e+") failed with status "+t+" "+r)}}]),i}(),X=function e(){u(this,e)},Y={GET:{type:"GET",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},HEAD:{type:"HEAD",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},POST:{type:"POST",defaultHeaders:{"Content-Type":"application/json"},headers:{},data:!0},PUT:{type:"PUT",defaultHeaders:{"Content-Type":"application/json"},headers:{},data:!0},DELETE:{type:"DELETE",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},CONNECT:{type:"CONNECT",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},OPTIONS:{type:"OPTIONS",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},TRACE:{type:"TRACE",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},PATCH:{type:"PATCH",defaultHeaders:{"Content-Type":"application/json"},headers:{},data:!1}},z=function(){function e(){u(this,e)}return t(e,null,[{key:"setEventType",value:function(e){this.eventType=this.isOfTypeEventType(e)?e:"promise"}},{key:"setLogLevel",value:function(e){return this.log.setLevel(e)}},{key:"getLogLevel",value:function(){return this.log.getLevel()}},{key:"setHeaders",value:function(e,t){if(Y.hasOwnProperty(e))for(var r in t)t.hasOwnProperty(r)&&X.hasOwnProperty(r)&&(Y[e].headers[r]=t[r])}},{key:"setMockup",value:function(e){var t,r;return this.mockup.data=null!=(t=e.data)?t:this.mockup.data,this.mockup.delay=null!=(r=e.delay)?r:this.mockup.delay,this.mockup}},{key:"getMockupData",value:function(){var r=this;switch(this.eventType){case"observable":return new W(function(e){setTimeout(function(){r.mockup.data?(e.next(r.mockup.data),e.complete()):e.error(null)},r.mockup.delay)});default:return this.promiseTimeout().then(function(){return new T(function(e,t){r.mockup.data?e(r.mockup.data):t(null)})})}}},{key:"get",value:function(e,t){return this.request(Y.GET.type,e,t,Y.GET.headers||Y.GET.defaultHeaders,null)}},{key:"head",value:function(e,t){return this.request(Y.HEAD.type,e,t,Y.HEAD.headers||Y.HEAD.defaultHeaders,null)}},{key:"post",value:function(e,t,r){return this.request(Y.POST.type,e,t,Y.POST.headers||Y.POST.defaultHeaders,r)}},{key:"put",value:function(e,t,r){return this.request(Y.PUT.type,e,t,Y.PUT.headers||Y.PUT.defaultHeaders,r)}},{key:"delete",value:function(e,t){return this.request(Y.DELETE.type,e,t,Y.DELETE.headers||Y.DELETE.defaultHeaders,null)}},{key:"connect",value:function(e,t){return this.request(Y.CONNECT.type,e,t,Y.CONNECT.headers||Y.CONNECT.defaultHeaders,null)}},{key:"options",value:function(e,t){return this.request(Y.OPTIONS.type,e,t,Y.OPTIONS.headers||Y.OPTIONS.defaultHeaders,null)}},{key:"trace",value:function(e,t){return this.request(Y.TRACE.type,e,t,Y.TRACE.headers||Y.TRACE.defaultHeaders,null)}},{key:"patch",value:function(e,t,r){return this.request(Y.PATCH.type,e,t,Y.PATCH.headers||Y.PATCH.defaultHeaders,r)}},{key:"request",value:function(e,t,r,n,o){if(this.mockup.data)return this.getMockupData();var s=new J(e,t,r,n,this.eventType,o||null);return s.call()}},{key:"promiseTimeout",value:function(){var t=this;return new T(function(e){return setTimeout(e,t.mockup.delay)})}},{key:"isOfTypeEventType",value:function(e){return["promise","observable"].includes(e)}}]),e}();z.log=H.addGroup("Aias"),z.eventType="promise",z.mockup={data:null,delay:200};var B={info:{id:1,name:"info",color:"#28a745"},time:{id:2,name:"time",color:"#28a745"},trace:{id:3,name:"trace",color:"#17a2b8"},warn:{id:4,name:"warn",color:"#ffc107"},error:{id:5,name:"error",color:"#dc3545"},off:{id:99,name:"off",color:null}},$=function(){function n(e,t,r){u(this,n),this._level="error",this._console=!0,this._maxLength=200,this.level=e||this._level,this.console="boolean"==typeof t?t:this._console,this.maxLength=r||this.maxLength}return t(n,[{key:"displayMessage",value:function(e){return this._console&&B[this._level].id<=e}},{key:"level",set:function(e){this._level=B.hasOwnProperty(e)?e:this._level},get:function(){return this._level}},{key:"console",set:function(e){this._console=!!e},get:function(){return this._console}},{key:"maxLength",set:function(e){this._maxLength=50<e?e:50},get:function(){return this._maxLength}}]),n}(),K=function(){function s(e,t){var r,n,o;u(this,s),this.id=e.id,this.name=e.name,this.color=e.color,this.content=t,this.date=(r=new Date,n=[S(r.getMonth()+1),S(r.getDate()),r.getFullYear().toString().substr(-2)],o=[S(r.getHours()),S(r.getMinutes()),S(r.getSeconds())],n.join("/")+" "+o.join(":"))}return t(s,[{key:"display",value:function(){"time"===this.name||this.name}}]),s}(),Q=function e(t){u(this,e),this.key=t,this.timestamp=(new Date).getTime()},Z=function(){function r(e,t){u(this,r),this.name=e,this.logs=[],this.timers=[],this.options=new $(t.level,t.console,t.maxLength)}return t(r,[{key:"setLevel",value:function(e){return this.options.level=e,this.options.level}},{key:"getLevel",value:function(){return this.options.level}},{key:"displayConsole",value:function(e){return this.options.console=e,this.options.console}},{key:"setMaxLength",value:function(e){return this.options.maxLength=e,this.options.maxLength}},{key:"getMaxLength",value:function(){return this.options.maxLength}},{key:"info",value:function(e){this.log(B.info,e)}},{key:"trace",value:function(e){this.log(B.trace,e)}},{key:"time",value:function(t){var e=this.timers.findIndex(function(e){return e.key===t});if(-1<e){var r=(new Date).getTime()-this.timers[e].timestamp;this.log(B.time,t+" completed in "+r+" ms"),this.timers.splice(e,1)}else this.addTimer(t),this.log(B.time,t+" started")}},{key:"warn",value:function(e){this.log(B.warn,e)}},{key:"error",value:function(e){this.log(B.error,e)}},{key:"initLogs",value:function(){this.logs=[]}},{key:"log",value:function(e,t){var r=new K(e,t);this.options.displayMessage(r.id)&&(this.addLog(r),r.display(this.name))}},{key:"addLog",value:function(e){this.logs.length>=this.options.maxLength&&this.logs.shift(),this.logs.push(e)}},{key:"addTimer",value:function(e){this.timers.length>=this.options.maxLength&&this.timers.shift(),this.timers.push(new Q(e))}}]),r}(),ee=function(){function e(){u(this,e)}return t(e,null,[{key:"setLevel",value:function(e){this.options.level=e;var t,r=f(this.groups);try{for(r.s();!(t=r.n()).done;){t.value.setLevel(this.options.level)}}catch(e){r.e(e)}finally{r.f()}return this.getLevel()}},{key:"getLevel",value:function(){return this.options.level}},{key:"displayConsole",value:function(e){this.options.console=e;var t,r=f(this.groups);try{for(r.s();!(t=r.n()).done;){t.value.displayConsole(this.options.console)}}catch(e){r.e(e)}finally{r.f()}return this.options.console}},{key:"addGroup",value:function(e){return this.getGroup(e)||this.createGroup(e)}},{key:"sendLogs",value:function(e,t){var n=this,r=[];t&&z.setHeaders("POST",t);var o,s=f(this.groups);try{for(s.s();!(o=s.n()).done;){var i=o.value;r.push.apply(r,a(i.logs))}}catch(e){s.e(e)}finally{s.f()}return z.post(e,"json",r).then(function(e){var t,r=f(n.groups);try{for(r.s();!(t=r.n()).done;){t.value.initLogs()}}catch(e){r.e(e)}finally{r.f()}return e}).catch(function(e){return e})}},{key:"getGroup",value:function(e){var t,r=f(this.groups);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.name===e)return n}}catch(e){r.e(e)}finally{r.f()}return null}},{key:"createGroup",value:function(e){var t=new Z(e,this.options);return this.groups.push(t),t}}]),e}();ee.groups=[],ee.options=new $;var te=window.AudioContext||window.webkitAudioContext||!1,re=function(){function i(e,t,r,n,o,s){u(this,i),this.eventType="promise",this.log=ee.addGroup("Aias"),this.method=e,this.url=t,this.responseType=r,this.async=!0,this.noCache=!1,this.headers=n,this.eventType=o||this.eventType,this.data=s||null}return t(i,[{key:"call",value:function(){switch(this.eventType){case"observable":return this.useObservable(this.url,this.responseType,this.data);default:return this.usePromise(this.url,this.responseType,this.data)}}},{key:"usePromise",value:function(s,i,e){var u=this;return new T(function(r,n){var o=new XMLHttpRequest;switch(s+=u.noCache?"?cache="+(new Date).getTime():"",o.open(u.method,s,u.async),o.responseType="audiobuffer"===i?"arraybuffer":i,u.setRequestHeaders(o),i){case"json":case"arraybuffer":case"audiobuffer":case"blob":o.onload=function(){if(4==o.readyState)if(200==o.status){var e=o.response;if(e)if(u.log.time("xhr "+s),u.logInfo(s,o.status,o.statusText),"audiobuffer"===i)if(te){var t=new te;t.decodeAudioData(e,function(e){t.close(),r(e)},function(e){u.log.error("xhr ("+u.method+":"+s+") failed with decodeAudioData error : "+e.message),t.close(),n({status:e.name,statusText:e.message})})}else u.log.error("xhr ("+u.method+":"+s+") failed with error : Web Audio API is not supported by your browser."),n({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"});else r(e);else u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})}else u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})};break;default:o.onreadystatechange=function(){4==o.readyState&&(200==o.status?(u.log.time("xhr "+s),u.logInfo(s,o.status,o.statusText),r(o.responseText)):(u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})))}}h(e)&&(e=JSON.stringify(e)),u.log.time("xhr "+s),o.send(e||null),u.log.info("xhr ("+u.method+":"+s+")sent")})}},{key:"useObservable",value:function(o,s,e){var i=this;return new W(function(r){var n=new XMLHttpRequest;switch(o+=i.noCache?"?cache="+(new Date).getTime():"",n.open(i.method,o,i.async),n.responseType="audiobuffer"===s?"arraybuffer":s,i.setRequestHeaders(n),s){case"json":case"arraybuffer":case"audiobuffer":case"blob":n.onload=function(){if(4==n.readyState)if(200==n.status){var e=n.response;if(e)if(i.log.time("xhr "+o),i.logInfo(o,n.status,n.statusText),"audiobuffer"===s)if(te){var t=new te;t.decodeAudioData(e,function(e){t.close(),r.next(e),r.complete()},function(e){i.log.error("xhr ("+i.method+":"+o+") failed with decodeAudioData error : "+e.message),t.close(),r.error({status:e.name,statusText:e.message}),r.complete()})}else i.log.error("xhr ("+i.method+":"+o+") failed with error : Web Audio API is not supported by your browser."),r.error({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"}),r.complete();else r.next(e),r.complete();else i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText}),r.complete()}else i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText}),r.complete()};break;default:n.onreadystatechange=function(){4==n.readyState&&(200==n.status?(i.log.time("xhr "+o),i.logInfo(o,n.status,n.statusText),r.next(n.responseText)):(i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText})),r.complete())}}h(e)&&(e=JSON.stringify(e)),n.send(e||null),i.log.time("xhr "+o),i.log.info("xhr ("+i.method+":"+o+")sent")})}},{key:"setRequestHeaders",value:function(e){for(var t in this.headers)this.headers.hasOwnProperty(t)&&e.setRequestHeader(t,this.headers[t])}},{key:"logInfo",value:function(e,t,r){this.log.info("xhr ("+this.method+":"+e+") done with status "+t+" "+r)}},{key:"logError",value:function(e,t,r){this.log.error("xhr ("+this.method+":"+e+") failed with status "+t+" "+r)}}]),i}(),ne={GET:{type:"GET",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},HEAD:{type:"HEAD",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},POST:{type:"POST",defaultHeaders:{"Content-Type":"application/json"},headers:{},data:!0},PUT:{type:"PUT",defaultHeaders:{"Content-Type":"application/json"},headers:{},data:!0},DELETE:{type:"DELETE",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},CONNECT:{type:"CONNECT",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},OPTIONS:{type:"OPTIONS",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},TRACE:{type:"TRACE",defaultHeaders:{"Content-Type":"application/x-www-form-urlencoded"},headers:{},data:!1},PATCH:{type:"PATCH",defaultHeaders:{"Content-Type":"application/json"},headers:{},data:!1}},oe=function(){function e(){u(this,e)}return t(e,null,[{key:"setEventType",value:function(e){this.eventType=this.isOfTypeEventType(e)?e:"promise"}},{key:"setLogLevel",value:function(e){return this.log.setLevel(e)}},{key:"getLogLevel",value:function(){return this.log.getLevel()}},{key:"setHeaders",value:function(e,t){if(ne.hasOwnProperty(e))for(var r in t)t.hasOwnProperty(r)&&(ne[e].headers[r]=t[r])}},{key:"setMockup",value:function(e){var t,r;return this.mockup.data=null!=(t=e.data)?t:this.mockup.data,this.mockup.delay=null!=(r=e.delay)?r:this.mockup.delay,this.mockup}},{key:"getMockupData",value:function(){var r=this;switch(this.eventType){case"observable":return new W(function(e){setTimeout(function(){r.mockup.data?(e.next(r.mockup.data),e.complete()):e.error(null)},r.mockup.delay)});default:return this.promiseTimeout().then(function(){return new T(function(e,t){r.mockup.data?e(r.mockup.data):t(null)})})}}},{key:"get",value:function(e,t){return this.request(ne.GET.type,e,t,ne.GET.headers||ne.GET.defaultHeaders,null)}},{key:"head",value:function(e,t){return this.request(ne.HEAD.type,e,t,ne.HEAD.headers||ne.HEAD.defaultHeaders,null)}},{key:"post",value:function(e,t,r){return this.request(ne.POST.type,e,t,ne.POST.headers||ne.POST.defaultHeaders,r)}},{key:"put",value:function(e,t,r){return this.request(ne.PUT.type,e,t,ne.PUT.headers||ne.PUT.defaultHeaders,r)}},{key:"delete",value:function(e,t){return this.request(ne.DELETE.type,e,t,ne.DELETE.headers||ne.DELETE.defaultHeaders,null)}},{key:"connect",value:function(e,t){return this.request(ne.CONNECT.type,e,t,ne.CONNECT.headers||ne.CONNECT.defaultHeaders,null)}},{key:"options",value:function(e,t){return this.request(ne.OPTIONS.type,e,t,ne.OPTIONS.headers||ne.OPTIONS.defaultHeaders,null)}},{key:"trace",value:function(e,t){return this.request(ne.TRACE.type,e,t,ne.TRACE.headers||ne.TRACE.defaultHeaders,null)}},{key:"patch",value:function(e,t,r){return this.request(ne.PATCH.type,e,t,ne.PATCH.headers||ne.PATCH.defaultHeaders,r)}},{key:"request",value:function(e,t,r,n,o){if(this.mockup.data)return this.getMockupData();var s=new re(e,t,r,n,this.eventType,o||null);return s.call()}},{key:"promiseTimeout",value:function(){var t=this;return new T(function(e){return setTimeout(e,t.mockup.delay)})}},{key:"isOfTypeEventType",value:function(e){return["promise","observable"].includes(e)}}]),e}();return oe.log=ee.addGroup("Aias"),oe.eventType="promise",oe.mockup={data:null,delay:200},e.HTTP=oe,e}({});