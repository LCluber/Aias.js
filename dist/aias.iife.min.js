/** MIT License
* 
* Copyright (c) 2010 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* https://github.com/LCluber/Aias.js
*/

var Aias=function(e){"use strict";function s(e){return e<10?"0"+e:e}function u(e){return null!==e&&"object"==typeof e&&!(null!==(t=e)&&t.constructor===Array);var t}var i={info:{id:1,name:"info",color:"#28a745"},trace:{id:2,name:"trace",color:"#17a2b8"},warn:{id:3,name:"warn",color:"#ffc107"},error:{id:4,name:"error",color:"#dc3545"},off:{id:99,name:"off",color:null}},r=function(){function e(e,t){var n,r,o;this.id=e.id,this.name=e.name,this.color=e.color,this.content=t,this.date=(n=new Date,r=[s(n.getMonth()+1),s(n.getDate()),n.getFullYear().toString().substr(-2)],o=[s(n.getHours()),s(n.getMinutes()),s(n.getSeconds())],r.join("/")+" "+o.join(":"))}return e.prototype.display=function(){},e}(),n=function(){function e(e,t){this.messages=[],this.name=e,this.messages=[],this.level=t}var t=e.prototype;return t.setLevel=function(e){return this.level=i.hasOwnProperty(e)?i[e]:this.level,this.getLevel()},t.getLevel=function(){return this.level.name},t.info=function(e){this.log(i.info,e)},t.trace=function(e){this.log(i.trace,e)},t.warn=function(e){this.log(i.warn,e)},t.error=function(e){this.log(i.error,e)},t.log=function(e,t){var n=new r(e,t);this.messages.push(n),this.level.id<=n.id&&n.display(this.name)},e}(),o=function(){function a(){}return a.setLevel=function(e){a.level=i.hasOwnProperty(e)?i[e]:a.level;var t=a.groups,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var o;if(n){if(r>=t.length)break;o=t[r++]}else{if((r=t.next()).done)break;o=r.value}o.setLevel(a.level.name)}return a.getLevel()},a.getLevel=function(){return a.level.name},a.getGroup=function(e){var t=a.groups,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var o;if(n){if(r>=t.length)break;o=t[r++]}else{if((r=t.next()).done)break;o=r.value}var s=o;if(s.name===e)return s}return null},a.addGroup=function(e){return this.getGroup(e)||this.pushGroup(e)},a.pushGroup=function(e){var t=new n(e,a.level);return a.groups.push(t),t},a}();o.level=i.error,o.groups=[];var l=window.AudioContext||window.webkitAudioContext||!1,t=function(){function e(e,t){this.log=o.addGroup("Aias"),this.method=e,this.async=!0,this.noCache=!1,this.headers=t}var t=e.prototype;return t.setHeaders=function(e){for(var t in e)e.hasOwnProperty(t)&&(this.headers[t]=e[t])},t.getHeaders=function(){return this.headers},t.call=function(s,a,e){var i=this;return new Promise(function(n,r){var o=new XMLHttpRequest;switch(s+=i.noCache?"?cache="+(new Date).getTime():"",o.open(i.method,s,i.async),o.responseType="audiobuffer"===a?"arraybuffer":a,i.setRequestHeaders(o),a){case"json":case"arraybuffer":case"audiobuffer":case"blob":o.onload=function(){if(4==o.readyState)if(200==o.status){var e=o.response;if(e)if(i.logInfo(s,o.status,o.statusText),"audiobuffer"===a)if(l){var t=new l;t.decodeAudioData(e,function(e){t.close(),n(e)},function(e){i.log.error("xhr ("+i.method+":"+s+") failed with decodeAudioData error : "+e.message),t.close(),r({status:e.name,statusText:e.message})})}else i.log.error("xhr ("+i.method+":"+s+") failed with error : Web Audio API is not supported by your browser."),r({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"});else n(e);else i.logError(s,o.status,o.statusText),r({status:o.status,statusText:o.statusText})}else i.logError(s,o.status,o.statusText),r({status:o.status,statusText:o.statusText})};break;default:o.onreadystatechange=function(){4==o.readyState&&(200==o.status?(i.logInfo(s,o.status,o.statusText),n(o.responseText)):(i.logError(s,o.status,o.statusText),r({status:o.status,statusText:o.statusText})))}}u(e)&&(e=JSON.stringify(e)),o.send(e||null),i.log.info("xhr ("+i.method+":"+s+")sent")})},t.setRequestHeaders=function(e){for(var t in this.headers)this.headers.hasOwnProperty(t)&&e.setRequestHeader(t,this.headers[t])},t.logInfo=function(e,t,n){this.log.info("xhr ("+this.method+":"+e+") done with status "+t+" "+n)},t.logError=function(e,t,n){this.log.error("xhr ("+this.method+":"+e+") failed with status "+t+" "+n)},e}(),a=function(){function e(){}return e.setLogLevel=function(e){return this.log.setLevel(e)},e.getLogLevel=function(){return this.log.getLevel()},e.GET=function(e,t){return this.get.call(e,t)},e.HEAD=function(e,t){return this.head.call(e,t)},e.POST=function(e,t,n){return this.post.call(e,t,n)},e.PUT=function(e,t,n){return this.put.call(e,t,n)},e.DELETE=function(e,t){return this.delete.call(e,t)},e.CONNECT=function(e,t){return this.connect.call(e,t)},e.OPTIONS=function(e,t){return this.options.call(e,t)},e.TRACE=function(e,t){return this.trace.call(e,t)},e.PATCH=function(e,t,n){return this.patch.call(e,t,n)},e}();return a.log=o.addGroup("Aias"),a.get=new t("GET",{"Content-Type":"application/x-www-form-urlencoded"}),a.head=new t("HEAD",{"Content-Type":"application/x-www-form-urlencoded"}),a.post=new t("POST",{"Content-Type":"application/json"}),a.put=new t("PUT",{"Content-Type":"application/json"}),a.delete=new t("DELETE",{"Content-Type":"application/x-www-form-urlencoded"}),a.connect=new t("CONNECT",{"Content-Type":"application/x-www-form-urlencoded"}),a.options=new t("OPTIONS",{"Content-Type":"application/x-www-form-urlencoded"}),a.trace=new t("TRACE",{"Content-Type":"application/x-www-form-urlencoded"}),a.patch=new t("PATCH",{"Content-Type":"application/json"}),e.HTTP=a,e}({});