/** MIT License
* 
* Copyright (c) 2010 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* https://github.com/LCluber/Aias.js
*/

var Aias=function(t){"use strict";function a(t){return t<10?"0"+t:t}function u(t){return null!==t&&"object"==typeof t&&!(null!==(e=t)&&e.constructor===Array);var e}var i={info:{id:1,name:"info",color:"#28a745"},trace:{id:2,name:"trace",color:"#17a2b8"},warn:{id:3,name:"warn",color:"#ffc107"},error:{id:4,name:"error",color:"#dc3545"},off:{id:99,name:"off",color:null}},n=function(){function t(t,e){var o,n,r;this.id=t.id,this.name=t.name,this.color=t.color,this.content=e,this.date=(o=new Date,n=[a(o.getMonth()+1),a(o.getDate()),o.getFullYear().toString().substr(-2)],r=[a(o.getHours()),a(o.getMinutes()),a(o.getSeconds())],n.join("/")+" "+r.join(":"))}return t.prototype.display=function(){},t}(),o=function(){function t(t,e){this.messages=[],this.name=t,this.messages=[],this.level=e}var e=t.prototype;return e.setLevel=function(t){return this.level=i.hasOwnProperty(t)?i[t]:this.level,this.getLevel()},e.getLevel=function(){return this.level.name},e.info=function(t){this.log(i.info,t)},e.trace=function(t){this.log(i.trace,t)},e.warn=function(t){this.log(i.warn,t)},e.error=function(t){this.log(i.error,t)},e.log=function(t,e){var o=new n(t,e);this.messages.push(o),this.level.id<=o.id&&o.display(this.name)},t}(),r=function(){function s(){}return s.setLevel=function(t){s.level=i.hasOwnProperty(t)?i[t]:s.level;var e=s.groups,o=Array.isArray(e),n=0;for(e=o?e:e[Symbol.iterator]();;){var r;if(o){if(n>=e.length)break;r=e[n++]}else{if((n=e.next()).done)break;r=n.value}r.setLevel(s.level.name)}return s.getLevel()},s.getLevel=function(){return s.level.name},s.getGroup=function(t){var e=s.groups,o=Array.isArray(e),n=0;for(e=o?e:e[Symbol.iterator]();;){var r;if(o){if(n>=e.length)break;r=e[n++]}else{if((n=e.next()).done)break;r=n.value}var a=r;if(a.name===t)return a}return null},s.addGroup=function(t){return this.getGroup(t)||this.pushGroup(t)},s.pushGroup=function(t){var e=new o(t,s.level);return s.groups.push(e),e},s}();r.level=i.error,r.groups=[];var c=window.AudioContext||window.webkitAudioContext||!1,e=function(){function t(t,e){this.log=r.addGroup("Aias"),this.method=t,this.async=!0,this.noCache=!1,this.headers=e}var e=t.prototype;return e.setHeaders=function(t){for(var e in t)t.hasOwnProperty(e)&&(this.headers[e]=t[e])},e.getHeaders=function(){return this.headers},e.call=function(a,s,t){var i=this;return new Promise(function(o,n){var r=new XMLHttpRequest;switch(a+=i.noCache?"?cache="+(new Date).getTime():"",r.open(i.method,a,i.async),r.responseType="audiobuffer"===s?"arraybuffer":s,i.setRequestHeaders(r),s){case"json":case"arraybuffer":case"audiobuffer":case"blob":r.onload=function(){if(4==r.readyState)if(200==r.status){var t=r.response;if(t)if(i.logInfo(a,r.status,r.statusText),"audiobuffer"===s)if(c){var e=new c;e.decodeAudioData(t,function(t){e.close(),o(t)},function(t){i.log.error("xhr ("+i.method+":"+a+") failed with decodeAudioData error : "+t.message),e.close(),n({status:t.name,statusText:t.message})})}else i.log.error("xhr ("+i.method+":"+a+") failed with error : Web Audio API is not supported by your browser."),n({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"});else o(t);else i.logError(a,r.status,r.statusText),n({status:r.status,statusText:r.statusText})}else i.logError(a,r.status,r.statusText),n({status:r.status,statusText:r.statusText})};break;default:r.onreadystatechange=function(){4==r.readyState&&(200==r.status?(i.logInfo(a,r.status,r.statusText),o(r.responseText)):(i.logError(a,r.status,r.statusText),n({status:r.status,statusText:r.statusText})))}}u(t)&&(t=JSON.stringify(t)),r.send(t||null),i.log.info("xhr ("+i.method+":"+a+")sent")})},e.setRequestHeaders=function(t){for(var e in this.headers)this.headers.hasOwnProperty(e)&&t.setRequestHeader(e,this.headers[e])},e.logInfo=function(t,e,o){this.log.info("xhr ("+this.method+":"+t+") done with status "+e+" "+o)},e.logError=function(t,e,o){this.log.error("xhr ("+this.method+":"+t+") failed with status "+e+" "+o)},t}(),s=function(){function t(){}return t.setLogLevel=function(t){return this.log.setLevel(t)},t.getLogLevel=function(){return this.log.getLevel()},t.getMockupData=function(){var o=this;return new Promise(function(t,e){o.mockupData?t(o.mockupData):e(null)})},t.setMockupData=function(t){this.mockupData=t},t.GET=function(t,e){return this.mockupData?this.getMockupData():this.get.call(t,e)},t.HEAD=function(t,e){return this.mockupData?this.getMockupData():this.head.call(t,e)},t.POST=function(t,e,o){return this.mockupData?this.getMockupData():this.post.call(t,e,o)},t.PUT=function(t,e,o){return this.mockupData?this.getMockupData():this.put.call(t,e,o)},t.DELETE=function(t,e){return this.mockupData?this.getMockupData():this.delete.call(t,e)},t.CONNECT=function(t,e){return this.mockupData?this.getMockupData():this.connect.call(t,e)},t.OPTIONS=function(t,e){return this.mockupData?this.getMockupData():this.options.call(t,e)},t.TRACE=function(t,e){return this.mockupData?this.getMockupData():this.trace.call(t,e)},t.PATCH=function(t,e,o){return this.mockupData?this.getMockupData():this.patch.call(t,e,o)},t}();return s.log=r.addGroup("Aias"),s.mockupData=null,s.get=new e("GET",{"Content-Type":"application/x-www-form-urlencoded"}),s.head=new e("HEAD",{"Content-Type":"application/x-www-form-urlencoded"}),s.post=new e("POST",{"Content-Type":"application/json"}),s.put=new e("PUT",{"Content-Type":"application/json"}),s.delete=new e("DELETE",{"Content-Type":"application/x-www-form-urlencoded"}),s.connect=new e("CONNECT",{"Content-Type":"application/x-www-form-urlencoded"}),s.options=new e("OPTIONS",{"Content-Type":"application/x-www-form-urlencoded"}),s.trace=new e("TRACE",{"Content-Type":"application/x-www-form-urlencoded"}),s.patch=new e("PATCH",{"Content-Type":"application/json"}),t.HTTP=s,t}({});