/** MIT License
* 
* Copyright (c) 2010 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* https://github.com/LCluber/Aias.js
*/

var Aias=function(t){"use strict";function i(t){"@babel/helpers - typeof";return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t))){var e=0,r=function(){};return{s:r,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,s=!0,i=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){i=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function c(t){return t<10?"0"+t:t}function l(t){return null!==t&&"object"===i(t)&&!(null!==(e=t)&&e.constructor===Array);var e}function r(t,e){function r(){this.constructor=t}T(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function h(t){return"function"==typeof t}function o(t){setTimeout(function(){throw t},0)}function f(t){return null!==t&&"object"===i(t)}function p(t){return t.reduce(function(t,e){return t.concat(e instanceof S?e.errors:e)},[])}function y(){}function d(t){if(t||(t=k.Promise||Promise),!t)throw new Error("no Promise impl found");return t}var b={info:{id:1,name:"info",color:"#28a745"},trace:{id:2,name:"trace",color:"#17a2b8"},warn:{id:3,name:"warn",color:"#ffc107"},error:{id:4,name:"error",color:"#dc3545"},off:{id:99,name:"off",color:null}},v=function(){function s(t,e){var r,n,o;u(this,s),this.id=t.id,this.name=t.name,this.color=t.color,this.content=e,this.date=(r=new Date,n=[c(r.getMonth()+1),c(r.getDate()),r.getFullYear().toString().substr(-2)],o=[c(r.getHours()),c(r.getMinutes()),c(r.getSeconds())],n.join("/")+" "+o.join(":"))}return e(s,[{key:"display",value:function(){}}]),s}(),m=function(){function r(t,e){u(this,r),this.messages=[],this.name=t,this.messages=[],this.level=e}return e(r,[{key:"setLevel",value:function(t){return this.level=b.hasOwnProperty(t)?b[t]:this.level,this.getLevel()}},{key:"getLevel",value:function(){return this.level.name}},{key:"info",value:function(t){this.log(b.info,t)}},{key:"trace",value:function(t){this.log(b.trace,t)}},{key:"warn",value:function(t){this.log(b.warn,t)}},{key:"error",value:function(t){this.log(b.error,t)}},{key:"log",value:function(t,e){var r=new v(t,e);this.messages.push(r),this.level.id<=r.id&&r.display(this.name)}}]),r}(),w=function(){function o(){u(this,o)}return e(o,null,[{key:"setLevel",value:function(t){o.level=b.hasOwnProperty(t)?b[t]:o.level;var e,r=s(o.groups);try{for(r.s();!(e=r.n()).done;){e.value.setLevel(o.level.name)}}catch(t){r.e(t)}finally{r.f()}return o.getLevel()}},{key:"getLevel",value:function(){return o.level.name}},{key:"getGroup",value:function(t){var e,r=s(o.groups);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(n.name===t)return n}}catch(t){r.e(t)}finally{r.f()}return null}},{key:"addGroup",value:function(t){return this.getGroup(t)||this.pushGroup(t)}},{key:"pushGroup",value:function(t){var e=new m(t,o.level);return o.groups.push(e),e}}]),o}();w.level=b.error,w.groups=[];var g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},_=!1,k={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t);_=t},get useDeprecatedSynchronousErrorHandling(){return _}},E={closed:!0,next:function(){},error:function(t){if(k.useDeprecatedSynchronousErrorHandling)throw t;o(t)},complete:function(){}},x=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}(),S=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),O=function(){function u(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var t;return u.prototype.unsubscribe=function(){var e;if(!this.closed){var t=this._parentOrParents,r=this._unsubscribe,n=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,t instanceof u)t.remove(this);else if(null!==t)for(var o=0;o<t.length;++o){t[o].remove(this)}if(h(r))try{r.call(this)}catch(t){e=t instanceof S?p(t.errors):[t]}if(x(n)){o=-1;for(var s=n.length;++o<s;){var i=n[o];if(f(i))try{i.unsubscribe()}catch(t){e=e||[],t instanceof S?e=e.concat(p(t.errors)):e.push(t)}}}if(e)throw new S(e)}},u.prototype.add=function(t){var e=t;if(!t)return u.EMPTY;switch(i(t)){case"function":e=new u(t);case"object":if(e===this||e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if(!(e instanceof u)){var r=e;(e=new u)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var n=e._parentOrParents;if(null===n)e._parentOrParents=this;else if(n instanceof u){if(n===this)return e;e._parentOrParents=[n,this]}else{if(-1!==n.indexOf(this))return e;n.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[e]:o.push(e),e},u.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},u.EMPTY=((t=new u).closed=!0,t),u}(),P=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),A=function(o){function s(t,e,r){var n=o.call(this)||this;switch(n.syncErrorValue=null,n.syncErrorThrown=!1,n.syncErrorThrowable=!1,n.isStopped=!1,arguments.length){case 0:n.destination=E;break;case 1:if(!t){n.destination=E;break}if("object"===i(t)){t instanceof s?(n.syncErrorThrowable=t.syncErrorThrowable,(n.destination=t).add(n)):(n.syncErrorThrowable=!0,n.destination=new D(n,t));break}default:n.syncErrorThrowable=!0,n.destination=new D(n,t,e,r)}return n}return r(s,o),s.prototype[P]=function(){return this},s.create=function(t,e,r){var n=new s(t,e,r);return n.syncErrorThrowable=!1,n},s.prototype.next=function(t){this.isStopped||this._next(t)},s.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},s.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},s.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,o.prototype.unsubscribe.call(this))},s.prototype._next=function(t){this.destination.next(t)},s.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},s.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},s.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},s}(O),D=function(u){function t(t,e,r,n){var o,s=u.call(this)||this;s._parentSubscriber=t;var i=s;return h(e)?o=e:e&&(o=e.next,r=e.error,n=e.complete,e!==E&&(h((i=Object.create(e)).unsubscribe)&&s.add(i.unsubscribe.bind(i)),i.unsubscribe=s.unsubscribe.bind(s))),s._context=i,s._next=o,s._error=r,s._complete=n,s}return r(t,u),t.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;k.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},t.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=k.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):o(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;o(t)}}},t.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};k.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,r):this.__tryOrUnsub(r),this.unsubscribe()}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),k.useDeprecatedSynchronousErrorHandling)throw t;o(t)}},t.prototype.__tryOrSetError=function(e,t,r){if(!k.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,r)}catch(t){return k.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0):(o(t),!0)}return!1},t.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},t}(A),H=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}(),C=function(){function r(t){this._isScalar=!1,t&&(this._subscribe=t)}return r.prototype.lift=function(t){var e=new r;return e.source=this,e.operator=t,e},r.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof A)return t;if(t[P])return t[P]()}return t||e||r?new A(t,e,r):new A(E)}(t,e,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||k.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),k.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){k.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof A?n:null}return!0}(e)&&e.error(t)}},r.prototype.forEach=function(n,t){var o=this;return new(t=d(t))(function(t,e){var r;r=o.subscribe(function(t){try{n(t)}catch(t){e(t),r&&r.unsubscribe()}},e,t)})},r.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},r.prototype[H]=function(){return this},r.prototype.pipe=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return 0===t.length?this:((e=t)?1===e.length?e[0]:function(t){return e.reduce(function(t,e){return e(t)},t)}:y)(this)},r.prototype.toPromise=function(t){var n=this;return new(t=d(t))(function(t,e){var r;n.subscribe(function(t){return r=t},function(t){return e(t)},function(){return t(r)})})},r.create=function(t){return new r(t)},r}();g||(g={});var j=window.AudioContext||window.webkitAudioContext||!1,M=function(){function r(t,e){u(this,r),this.log=w.addGroup("Aias"),this.method=t,this.async=!0,this.noCache=!1,this.headers=e}return e(r,[{key:"setHeaders",value:function(t){for(var e in t)t.hasOwnProperty(e)&&(this.headers[e]=t[e])}},{key:"getHeaders",value:function(){return this.headers}},{key:"usePromise",value:function(s,i,t){var u=this;return new Promise(function(r,n){var o=new XMLHttpRequest;switch(s+=u.noCache?"?cache="+(new Date).getTime():"",o.open(u.method,s,u.async),o.responseType="audiobuffer"===i?"arraybuffer":i,u.setRequestHeaders(o),i){case"json":case"arraybuffer":case"audiobuffer":case"blob":o.onload=function(){if(4==o.readyState)if(200==o.status){var t=o.response;if(t)if(u.logInfo(s,o.status,o.statusText),"audiobuffer"===i)if(j){var e=new j;e.decodeAudioData(t,function(t){e.close(),r(t)},function(t){u.log.error("xhr ("+u.method+":"+s+") failed with decodeAudioData error : "+t.message),e.close(),n({status:t.name,statusText:t.message})})}else u.log.error("xhr ("+u.method+":"+s+") failed with error : Web Audio API is not supported by your browser."),n({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"});else r(t);else u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})}else u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})};break;default:o.onreadystatechange=function(){4==o.readyState&&(200==o.status?(u.logInfo(s,o.status,o.statusText),r(o.responseText)):(u.logError(s,o.status,o.statusText),n({status:o.status,statusText:o.statusText})))}}l(t)&&(t=JSON.stringify(t)),o.send(t||null),u.log.info("xhr ("+u.method+":"+s+")sent")})}},{key:"useObservable",value:function(o,s,t){var i=this;return new C(function(r){var n=new XMLHttpRequest;switch(o+=i.noCache?"?cache="+(new Date).getTime():"",n.open(i.method,o,i.async),n.responseType="audiobuffer"===s?"arraybuffer":s,i.setRequestHeaders(n),s){case"json":case"arraybuffer":case"audiobuffer":case"blob":n.onload=function(){if(4==n.readyState)if(200==n.status){var t=n.response;if(t)if(i.logInfo(o,n.status,n.statusText),"audiobuffer"===s)if(j){var e=new j;e.decodeAudioData(t,function(t){e.close(),r.next(t),r.complete()},function(t){i.log.error("xhr ("+i.method+":"+o+") failed with decodeAudioData error : "+t.message),e.close(),r.error({status:t.name,statusText:t.message}),r.complete()})}else i.log.error("xhr ("+i.method+":"+o+") failed with error : Web Audio API is not supported by your browser."),r.error({status:"Web Audio API not supported by your browser",statusText:"Web Audio API is not supported by your browser"}),r.complete();else r.next(t),r.complete();else i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText}),r.complete()}else i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText}),r.complete()};break;default:n.onreadystatechange=function(){4==n.readyState&&(200==n.status?(i.logInfo(o,n.status,n.statusText),r.next(n.responseText)):(i.logError(o,n.status,n.statusText),r.error({status:n.status,statusText:n.statusText})),r.complete())}}l(t)&&(t=JSON.stringify(t)),n.send(t||null),i.log.info("xhr ("+i.method+":"+o+")sent")})}},{key:"call",value:function(t,e,r,n){switch(r){case"observable":return this.useObservable(t,e,n);default:return this.usePromise(t,e,n)}}},{key:"setRequestHeaders",value:function(t){for(var e in this.headers)this.headers.hasOwnProperty(e)&&t.setRequestHeader(e,this.headers[e])}},{key:"logInfo",value:function(t,e,r){this.log.info("xhr ("+this.method+":"+t+") done with status "+e+" "+r)}},{key:"logError",value:function(t,e,r){this.log.error("xhr ("+this.method+":"+t+") failed with status "+e+" "+r)}}]),r}(),L=function(){function t(){u(this,t)}return e(t,null,[{key:"setEventType",value:function(t){this.eventType=this.isOfTypeEventType(t)?t:"promise"}},{key:"isOfTypeEventType",value:function(t){return["promise","observable"].includes(t)}},{key:"setLogLevel",value:function(t){return this.log.setLevel(t)}},{key:"getLogLevel",value:function(){return this.log.getLevel()}},{key:"setMockup",value:function(t){var e,r;return this.mockup.data=null!=(e=t.data)?e:this.mockup.data,this.mockup.delay=null!=(r=t.delay)?r:this.mockup.delay,this.mockup}},{key:"getMockupData",value:function(){var r=this;switch(this.eventType){case"observable":return new C(function(t){setTimeout(function(){r.mockup.data?(t.next(r.mockup.data),t.complete()):t.error(null)},r.mockup.delay)});default:return this.promiseTimeout().then(function(){return new Promise(function(t,e){r.mockup.data?t(r.mockup.data):e(null)})})}}},{key:"promiseTimeout",value:function(){var e=this;return new Promise(function(t){return setTimeout(t,e.mockup.delay)})}},{key:"GET",value:function(t,e){return this.mockup.data?this.getMockupData():this.get.call(t,e,this.eventType)}},{key:"HEAD",value:function(t,e){return this.mockup.data?this.getMockupData():this.head.call(t,e,this.eventType)}},{key:"POST",value:function(t,e,r){return this.mockup.data?this.getMockupData():this.post.call(t,e,this.eventType,r)}},{key:"PUT",value:function(t,e,r){return this.mockup.data?this.getMockupData():this.put.call(t,e,this.eventType,r)}},{key:"DELETE",value:function(t,e){return this.mockup.data?this.getMockupData():this.delete.call(t,e,this.eventType)}},{key:"CONNECT",value:function(t,e){return this.mockup.data?this.getMockupData():this.connect.call(t,e,this.eventType)}},{key:"OPTIONS",value:function(t,e){return this.mockup.data?this.getMockupData():this.options.call(t,e,this.eventType)}},{key:"TRACE",value:function(t,e){return this.mockup.data?this.getMockupData():this.trace.call(t,e,this.eventType)}},{key:"PATCH",value:function(t,e,r){return this.mockup.data?this.getMockupData():this.patch.call(t,e,this.eventType,r)}}]),t}();return L.log=w.addGroup("Aias"),L.eventType="promise",L.mockup={data:null,delay:200},L.get=new M("GET",{"Content-Type":"application/x-www-form-urlencoded"}),L.head=new M("HEAD",{"Content-Type":"application/x-www-form-urlencoded"}),L.post=new M("POST",{"Content-Type":"application/json"}),L.put=new M("PUT",{"Content-Type":"application/json"}),L.delete=new M("DELETE",{"Content-Type":"application/x-www-form-urlencoded"}),L.connect=new M("CONNECT",{"Content-Type":"application/x-www-form-urlencoded"}),L.options=new M("OPTIONS",{"Content-Type":"application/x-www-form-urlencoded"}),L.trace=new M("TRACE",{"Content-Type":"application/x-www-form-urlencoded"}),L.patch=new M("PATCH",{"Content-Type":"application/json"}),t.HTTP=L,t}({});